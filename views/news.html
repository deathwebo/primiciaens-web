<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="/static/css/chota.min.css">
    <link rel="stylesheet" href="/static/css/custom.css">

    <script>
      function registerVisit(el) {
        if (!el.target.dataset.id) {
          return true;
        }
        var url = "/news/"+el.target.dataset.id+"/visits";
        var params = "";
        var xhr = new XMLHttpRequest();
        xhr.open("POST", url, true);

        //Send the proper header information along with the request
        xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

        xhr.send(params);
      }

      window.onload = function() {
        anchors = document.getElementsByClassName('news-url')
        for(var i = 0; i < anchors.length; i++) {
          var anchor = anchors[i];
          anchor.onclick = registerVisit
        }
      }

    </script>
  <head>
    <title>PrimiciaEns</title>
  </head>
  <body>
    <h1 class="title"><a href="/">PrimiciaEns</a></h1>
    <div class="news">
      <ol class="news-list" start="{{ start }}">
        % for new in news:
          <li class="news-item">
            <div class="news-title">
              <a 
                data-id="{{ new['id'] }}"
                class="news-url"
                href="{{ new['url'] }}">
                {{new['title']}}
              </a> <small class="text-gray">({{ new["website"] }})</small>
            </div>
            <small class="text-gray">{{ ellapsed_time(new["datetimeAdded"]) }}</small>
          </li>
        % end
      </ol>
    </div>
    <div class="paging">
      <a class="button primary" href="/news?p={{ int(page) + 1 }}">ver m√°s</a>
    </div>
  </body>
</html>